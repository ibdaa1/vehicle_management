<?php
// db.php - ููู ููุญุฏ ููุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช

// โ๏ธ ูุชู ุญุฐู ุฏุงูุฉ connectDB() ูุชุฌูุจ ุงูุชุนุงุฑุถ ูุชูุฑุงุฑ ุชุนุฑูู ุงูุงุชุตุงู.

// โ๏ธ ูู ุจุชุญุฏูุซ ูุฐู ุงููุชุบูุฑุงุช ุจูุนูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจู
$servername = "sv61.ifastnet10.org"; 
$username   = "hcsfcsto_user";
$password   = "Mohd28332@"; // ๐จ ููุถู ูุถุน ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูู ููู .env ุฃู ุฎุงุฑุฌ ูุฌูุฏ ุงูููุจ
$dbname     = "hcsfcsto_vehicle_management";

// --- ุฅูุดุงุก ุงุชุตุงู (ูุชู ุชุฎุฒููู ูุจุงุดุฑุฉ ูู ุงููุชุบูุฑ $conn) ---
$conn = new mysqli($servername, $username, $password, $dbname);

// --- ุงูุชุญูู ูู ุงูุงุชุตุงู ---
if ($conn->connect_error) {
    // ุชุณุฌูู ุงูุฎุทุฃ ูู ุงูุณุฌู ุงูุฎุงุต ุจุงูุฎุงุฏู (ููู)
    error_log("ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช: " . $conn->connect_error);
    
    // ุฅุนุฏุงุฏ ุฑุณุงูุฉ ุงูุฎุทุฃ ูููุณุชุฎุฏู
    $errorMessage = ['status' => 'error', 'message' => 'ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช.'];

    // ุฅุฐุง ูุงู ุงูุทูุจ AJAX ุฃู API (ูุชุฌูุจ ุฅุฎุฑุงุฌ HTML ุนุดูุงุฆู)
    if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) === 'xmlhttprequest') {
        // ุชุฃูุฏ ูู ุฃููุง ูุฑุณู JSON (ููุท ุฅุฐุง ูู ูุชู ุฅุฑุณุงู ุฃู output ูุจูู)
        if (!headers_sent()) {
            header('Content-Type: application/json; charset=utf-8');
        }
        die(json_encode($errorMessage, JSON_UNESCAPED_UNICODE));
    } else {
        // ุฅุฎุฑุงุฌ ุฎุทุฃ ุจุณูุท ููุชุตูุญ ุงูููุจ ุงูุนุงุฏู
        die("ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช. ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู.");
    }
}

// --- ุชุนููู ุชุฑููุฒ ุงูุฃุญุฑู ---
// ุชุนููู utf8mb4 ูุฏุนู Emoji ูุฃุญุฑู ุฎุงุตุฉ ุฃูุซุฑ ูู utf8
$conn->set_charset("utf8mb4");

// ๐ก ุงููุชุบูุฑ $conn ุฌุงูุฒ ุงูุขู ููุงุณุชุฎุฏุงู ูู ุฃู ููู ูููู ุจุชุถููู 'db.php'
?>